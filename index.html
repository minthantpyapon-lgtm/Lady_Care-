<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lady Care Pro</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="https://img.icons8.com/fluency/512/calendar-2026.png">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="apple-touch-icon" href="https://img.icons8.com/fluency/512/calendar-2026.png">
    <meta name="theme-color" content="#ff4d94">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root { --pink: #ff4d94; --bg: #fff0f5; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; padding: 0; }
        .wrapper { display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .card { background: white; width: 100%; max-width: 350px; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); text-align: center; margin-top: 20px; }
        .logo { font-size: 28px; font-weight: bold; color: var(--pink); margin-bottom: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .input-field { width: 100%; height: 50px; margin-bottom: 15px; padding: 0 15px; border: 2px solid #f0f0f0; border-radius: 12px; box-sizing: border-box; font-size: 16px; outline: none; background: #fafafa; }
        .btn-pink { width: 100%; height: 50px; background: var(--pink); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; }
        .navbar { background: var(--pink); color: white; padding: 15px; position: fixed; top: 0; width: 100%; z-index: 1000; box-sizing: border-box; display: flex; justify-content: space-between; align-items: center; }
        .menu-list { display: none; position: absolute; right: 15px; top: 60px; background: white; border-radius: 12px; width: 170px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .menu-list a { display: block; padding: 15px; color: #333; text-decoration: none; border-bottom: 1px solid #f5f5f5; }
        .show { display: block; }
        .main-content { padding-top: 100px; width: 100%; display: flex; flex-direction: column; align-items: center; }
        .result-box { background: #fff5f8; padding: 20px; border-radius: 15px; margin-top: 25px; border-left: 6px solid var(--pink); text-align: left; width: 100%; box-sizing: border-box; }
        .res-date { color: var(--pink); font-weight: bold; float: right; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="loginPage" class="wrapper">
        <div class="card">
            <div class="logo">ðŸŒ¸ Lady Care ðŸŒ¸ </div>
            <p id="loginSub">Please sign in</p>
            <input type="text" id="username" class="input-field" placeholder="Username">
            <input type="password" id="password" class="input-field" placeholder="Password">
            <button onclick="handleLogin()" id="loginBtn" class="btn-pink">Login</button>
        </div>
    </div>

    <div id="appPage" class="hidden">
        <nav class="navbar">
            <span>LADY CARE PRO</span>
            <div style="cursor:pointer;" onclick="toggleMenu()">â˜°</div>
            <div id="menuList" class="menu-list">
                <a href="#" onclick="switchLang('en')">English</a>
                <a href="#" onclick="switchLang('mm')">á€™á€¼á€”á€ºá€™á€¬á€…á€¬</a>
                <a href="#" onclick="handleLogout()" style="color: red;">Logout</a>
            </div>
        </nav>

        <div class="main-content">
            <div class="card">
                <h3><span id="greet">Welcome</span>, <span id="displayUser"></span>!</h3>
                <p id="instruction">Select last period start date:</p>
                <input type="date" id="lastDate" class="input-field" onchange="autoCalculate()">
                <div id="resultArea" class="hidden">
                    <div class="result-box">
                        <p><span id="nextText">Next Period</span> <span id="nextDateRes" class="res-date"></span></p>
                        <p><span id="ovuText">Ovulation Day</span> <span id="ovuDateRes" class="res-date"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            en: { loginSub: "Please sign in", loginBtn: "Login", greet: "Welcome", instruction: "Select last period start date:", nextText: "Next Period:", ovuText: "Ovulation Day:", error: "Enter both fields!" },
            mm: { loginSub: "á€¡á€€á€±á€¬á€„á€·á€ºá€á€„á€ºá€•á€«", loginBtn: "á€á€„á€ºá€™á€Šá€º", greet: "á€™á€„á€ºá€¹á€‚á€œá€¬á€•á€«", instruction: "á€”á€±á€¬á€€á€ºá€†á€¯á€¶á€¸á€›á€¬á€žá€®á€œá€¬á€žá€Šá€·á€ºá€›á€€á€ºá€€á€­á€¯ á€›á€½á€±á€¸á€•á€« -", nextText: "á€”á€±á€¬á€€á€ºá€á€…á€ºá€€á€¼á€­á€™á€ºá€œá€¬á€™á€Šá€·á€ºá€›á€€á€º -", ovuText: "á€™á€»á€­á€¯á€¸á€¥á€€á€¼á€½á€±á€™á€Šá€·á€ºá€›á€€á€º -", error: "á€¡á€€á€½á€€á€ºá€¡á€¬á€¸á€œá€¯á€¶á€¸ á€–á€¼á€Šá€·á€ºá€•á€«" }
        };

        function toggleMenu() { document.getElementById("menuList").classList.toggle("show"); }

        function handleLogin() {
            const u = document.getElementById('username').value.trim();
            const p = document.getElementById('password').value.trim();
            if (!u || !p) { alert(translations[localStorage.getItem('lang')||'en'].error); return; }
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('username', u);
            checkAuth();
        }

        function checkAuth() {
            if (localStorage.getItem('isLoggedIn') === 'true') {
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('appPage').classList.remove('hidden');
                document.getElementById('displayUser').innerText = localStorage.getItem('username');
                applyLanguage();
                loadSavedData();
            }
        }

        function autoCalculate() {
            const dateVal = document.getElementById('lastDate').value;
            if (!dateVal) return;
            const lastDate = new Date(dateVal);
            const nextDate = new Date(lastDate);
            nextDate.setDate(lastDate.getDate() + 28);
            const ovuDate = new Date(nextDate);
            ovuDate.setDate(nextDate.getDate() - 14);
            localStorage.setItem('savedLast', dateVal);
            localStorage.setItem('savedNext', nextDate.toISOString());
            localStorage.setItem('savedOvu', ovuDate.toISOString());
            displayResults(nextDate, ovuDate);
        }

        function displayResults(next, ovu) {
            document.getElementById('resultArea').classList.remove('hidden');
            document.getElementById('nextDateRes').innerText = next.toDateString();
            document.getElementById('ovuDateRes').innerText = ovu.toDateString();
        }

        function loadSavedData() {
            const last = localStorage.getItem('savedLast');
            const next = localStorage.getItem('savedNext');
            const ovu = localStorage.getItem('savedOvu');
            if (last) document.getElementById('lastDate').value = last;
            if (next && ovu) displayResults(new Date(next), new Date(ovu));
        }

        function switchLang(lang) {
            localStorage.setItem('lang', lang);
            applyLanguage();
            toggleMenu();
        }

        function applyLanguage() {
            const lang = localStorage.getItem('lang') || 'en';
            const t = translations[lang];
            document.getElementById('loginSub').innerText = t.loginSub;
            document.getElementById('loginBtn').innerText = t.loginBtn;
            document.getElementById('greet').innerText = t.greet;
            document.getElementById('instruction').innerText = t.instruction;
            document.getElementById('nextText').innerText = t.nextText;
            document.getElementById('ovuText').innerText = t.ovuText;
        }

        function handleLogout() { localStorage.clear(); location.reload(); }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').then(reg => {
                    if (Notification.permission !== 'granted') {
                        Notification.requestPermission();
                    }
                });
            });
        }

        window.onload = checkAuth;
    </script>
</body>
</html>
